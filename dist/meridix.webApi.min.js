/*! Meridix-WebAPI-JS - v0.0.1 - 2014-09-11
* https://github.com/meridixsystems/Meridix-WebApi-JS
* Copyright (c) 2014 ; Licensed MIT */
var meridix=meridix||{};meridix.webApi=meridix.webApi||{},meridix.webApi.createSignedUrl=function(a,b,c,d){function e(a){d.consoleLoggingEnabled&&console&&console.log&&console.log(a)}function f(a){for(var b="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",c="",d=a;d>0;--d)c+=b[Math.round(Math.random()*(b.length-1))];return c}function g(a){if(!CryptoJS||!CryptoJS.MD5)throw"CryptoJS (.MD5) is not defined. Make sure that it is referenced and loaded prior to calling this method.";var b=CryptoJS.MD5(a);return b.toString(CryptoJS.enc.Hex)}function h(a,b){for(var c="0",d=0;b>d;d++)c+="0";return(c+a).slice(-1*b)}function i(a){return""+a.getFullYear()+h(a.getMonth()+1,2)+h(a.getDate(),2)+h(a.getHours(),2)+h(a.getMinutes(),2)+h(a.getSeconds(),2)}d=d||{consoleLoggingEnabled:!1,parameters:void 0},e("Token:\n"+b),e("Secret:\n"+c);var j=a;e("Request URL:\n"+j);var k=f(20);e("Nonce:\n"+k);var l=new Date,m=new Date(l.getTime()+6e4*l.getTimezoneOffset()),n=i(m);e("Timestamp:\n"+n);var o=["auth_nonce="+k,"auth_timestamp="+n,"auth_token="+b];d.parameters&&(o=o.concat(d.parameters)),o.sort();var p=o.join("&");e("ParametersConcated:\n"+p);var q=encodeURIComponent(p);e("ParametersConcatedEncoded:\n"+q);var r=encodeURIComponent(j);e("RequestEncoded:\n"+r);var s="GET&"+r+"&"+q+"&"+c;e("VerbRequestQuery:\n"+s);var t=g(s);e("Signature:\n"+t);var u=j+"?"+p+"&auth_signature="+t;return e("SignedRequest:\n"+u),u};